<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <record id="action_report_workorder_maintenance" model="ir.actions.report">
        <field name="name">Workorder Maintenance Report</field>
        <field name="model">maintenance.workorder</field>
        <field name="report_type">qweb-pdf</field>
        <field name="report_name">facilities_management.report_workorder_maintenance_template</field>
        <field name="report_file">facilities_management.report_workorder_maintenance_template</field>
        <field name="print_report_name">'Workorder Report - %s' % (object.name)</field>
        <field name="binding_model_id" ref="facilities_management.model_maintenance_workorder"/>
        <field name="binding_type">report</field>
    </record>

    <template id="report_workorder_maintenance_template">
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="wo">
                <t t-call="web.external_layout">
                    <div class="page" style="padding:28px; max-width:900px; background:#f7fafc;">
                        <div style="border-radius:12px; background:#fff; padding:24px; box-shadow:0 2px 8px #e2e8f0; margin-bottom:32px;">
                            <div style="display:flex; align-items:center; gap:24px; padding-bottom:18px; border-bottom:2px solid #e2e8f0;">
                                <div style="flex:1;">
                                    <h2 style="margin:0; color:#3151b7; font-size:2.1rem; letter-spacing:0.03em;">Workorder Maintenance Report</h2>
                                    <div style="font-size:16px; color:#666; margin-top:3px;">
                                        <span style="background:#e3f6fc; color:#31708f; padding:3px 10px; border-radius:6px; margin-right:8px;">
                                            <b>Reference:</b> <span t-field="wo.name"/>
                                        </span>
                                        <span style="background:#e3f1fc; color:#31708f; padding:3px 10px; border-radius:6px;">
                                            <b>Type:</b> <span t-field="wo.work_order_type"/>
                                        </span>
                                    </div>
                                </div>
                                <div>
                                    <span style="display:inline-block; background:#eafaf1; color:#28a745; font-weight:700; padding:7px 14px; font-size:13px; border-radius:7px;">
                                        <t t-if="wo.status == 'done'">&#10004; Completed</t>
                                        <t t-elif="wo.status == 'in_progress'" style="color:#1c7ed6;">&#9889; In Progress</t>
                                        <t t-elif="wo.status == 'draft'" style="color:#ff922b;">&#9203; Draft</t>
                                        <t t-elif="wo.status == 'cancelled'" style="color:#d63031;">&#10060; Cancelled</t>
                                        <t t-else=""><span t-field="wo.status"/></t>
                                    </span>
                                </div>
                            </div>
                            <table style="width:100%; font-size:15px; border-collapse:collapse; margin-top:18px;">
                                <tr style="background:#edf6fb;">
                                    <td style="font-weight:600; color:#347ab7; width:28%; padding:8px;">Asset</td>
                                    <td style="padding:8px;"><span t-field="wo.asset_id.name"/></td>
                                </tr>
                                <tr>
                                    <td style="font-weight:600; color:#347ab7; padding:8px;">Facility</td>
                                    <td style="padding:8px;"><span t-field="wo.facility_id.name"/></td>
                                </tr>
                                <tr style="background:#e3f1fc;">
                                    <td style="font-weight:600; color:#31708f; padding:8px;">Room</td>
                                    <td style="padding:8px;"><span t-field="wo.room_id.name"/></td>
                                </tr>
                                <tr>
                                    <td style="font-weight:600; color:#31708f; padding:8px;">Building</td>
                                    <td style="padding:8px;"><span t-field="wo.building_id.name"/></td>
                                </tr>
                                <tr style="background:#edf6fb;">
                                    <td style="font-weight:600; color:#347ab7; padding:8px;">Floor</td>
                                    <td style="padding:8px;"><span t-field="wo.floor_id.name"/></td>
                                </tr>
                                <tr>
                                    <td style="font-weight:600; color:#31708f; padding:8px;">Priority</td>
                                    <td style="padding:8px;">
                                        <t t-if="wo.priority == '3'"><span style="color:#d63031; font-weight:700;">&#11088; High</span></t>
                                        <t t-elif="wo.priority == '2'"><span style="color:#fd7e14; font-weight:700;">Medium</span></t>
                                        <t t-elif="wo.priority == '1'"><span style="color:#1c7ed6; font-weight:700;">Low</span></t>
                                        <t t-elif="wo.priority == '0'"><span style="color:#636e72; font-weight:700;">Very Low</span></t>
                                        <t t-else=""><span t-field="wo.priority"/></t>
                                    </td>
                                </tr>
                                <tr style="background:#e3f1fc;">
                                    <td style="font-weight:600; color:#31708f; padding:8px;">Service Type</td>
                                    <td style="padding:8px;"><span t-field="wo.service_type"/></td>
                                </tr>
                                <tr>
                                    <td style="font-weight:600; color:#347ab7; padding:8px;">Maintenance Team</td>
                                    <td style="padding:8px;"><span t-field="wo.maintenance_team_id.name"/></td>
                                </tr>
                                <tr style="background:#edf6fb;">
                                    <td style="font-weight:600; color:#347ab7; padding:8px;">Scheduled Start</td>
                                    <td style="padding:8px;"><span t-field="wo.start_date"/></td>
                                </tr>
                                <tr>
                                    <td style="font-weight:600; color:#347ab7; padding:8px;">Scheduled End</td>
                                    <td style="padding:8px;"><span t-field="wo.end_date"/></td>
                                </tr>
                                <tr style="background:#e3f1fc;">
                                    <td style="font-weight:600; color:#31708f; padding:8px;">Actual Start</td>
                                    <td style="padding:8px;"><span t-field="wo.actual_start_date"/></td>
                                </tr>
                                <tr>
                                    <td style="font-weight:600; color:#31708f; padding:8px;">Actual End</td>
                                    <td style="padding:8px;"><span t-field="wo.actual_end_date"/></td>
                                </tr>
                                <tr style="background:#edf6fb;">
                                    <td style="font-weight:600; color:#347ab7; padding:8px;">Approval State</td>
                                    <td style="padding:8px;">
                                        <span t-field="wo.approval_state"/>
                                    </td>
                                </tr>
                                <tr>
                                    <td style="font-weight:600; color:#31708f; padding:8px;">Technician</td>
                                    <td style="padding:8px;">
                                        <t t-if="wo.technician_id"><span t-field="wo.technician_id.name"/></t>
                                        <t t-else=""><span style="color:#bbb;">&#8212;</span></t>
                                    </td>
                                </tr>
                                <tr style="background:#e3f1fc;">
                                    <td style="font-weight:600; color:#31708f; padding:8px;">Supervisor</td>
                                    <td style="padding:8px;">
                                        <t t-if="wo.supervisor_id"><span t-field="wo.supervisor_id.name"/></t>
                                        <t t-else=""><span style="color:#bbb;">&#8212;</span></t>
                                    </td>
                                </tr>
                                <tr>
                                    <td style="font-weight:600; color:#31708f; padding:8px;">Manager</td>
                                    <td style="padding:8px;">
                                        <t t-if="wo.manager_id"><span t-field="wo.manager_id.name"/></t>
                                        <t t-else=""><span style="color:#bbb;">&#8212;</span></t>
                                    </td>
                                </tr>
                                <tr style="background:#edf6fb;">
                                    <td style="font-weight:600; color:#347ab7; padding:8px;">SLA</td>
                                    <td style="padding:8px;"><span t-field="wo.sla_id.name"/></td>
                                </tr>
                                <tr>
                                    <td style="font-weight:600; color:#347ab7; padding:8px;">SLA Response Deadline</td>
                                    <td style="padding:8px;"><span t-field="wo.sla_response_deadline"/></td>
                                </tr>
                                <tr style="background:#e3f1fc;">
                                    <td style="font-weight:600; color:#31708f; padding:8px;">SLA Resolution Deadline</td>
                                    <td style="padding:8px;"><span t-field="wo.sla_resolution_deadline"/></td>
                                </tr>
                                <tr>
                                    <td style="font-weight:600; color:#347ab7; padding:8px;">SLA Response Status</td>
                                    <td style="padding:8px;">
                                        <t t-if="wo.sla_response_status == 'on_time'"><span style="color:#28a745;">&#9679; On Time</span></t>
                                        <t t-elif="wo.sla_response_status == 'warning'"><span style="color:#fd7e14;">&#9888; Warning</span></t>
                                        <t t-elif="wo.sla_response_status == 'critical'"><span style="color:#d63031;">&#10060; Critical</span></t>
                                        <t t-elif="wo.sla_response_status == 'breached'"><span style="color:#d63031;">&#10060; Breached</span></t>
                                        <t t-else=""><span t-field="wo.sla_response_status"/></t>
                                    </td>
                                </tr>
                                <tr style="background:#e3f1fc;">
                                    <td style="font-weight:600; color:#31708f; padding:8px;">SLA Resolution Status</td>
                                    <td style="padding:8px;">
                                        <t t-if="wo.sla_resolution_status == 'on_time'"><span style="color:#28a745;">&#9679; On Time</span></t>
                                        <t t-elif="wo.sla_resolution_status == 'warning'"><span style="color:#fd7e14;">&#9888; Warning</span></t>
                                        <t t-elif="wo.sla_resolution_status == 'critical'"><span style="color:#d63031;">&#10060; Critical</span></t>
                                        <t t-elif="wo.sla_resolution_status == 'breached'"><span style="color:#d63031;">&#10060; Breached</span></t>
                                        <t t-else=""><span t-field="wo.sla_resolution_status"/></t>
                                    </td>
                                </tr>
                                <tr>
                                    <td style="font-weight:600; color:#347ab7; padding:8px;">Description</td>
                                    <td style="padding:8px;"><span t-field="wo.description"/></td>
                                </tr>
                                <tr style="background:#edf6fb;">
                                    <td style="font-weight:600; color:#347ab7; padding:8px;">Work Done Notes</td>
                                    <td style="padding:8px;"><span t-field="wo.work_done"/></td>
                                </tr>
                            </table>
                        </div>

                        <div style="border-radius:12px; background:#fff; padding:20px; box-shadow:0 2px 8px #e2e8f0; margin-bottom:24px;">
                            <h3 style="color:#3151b7; border-bottom:1px solid #e2e8f0; padding-bottom:4px; margin-bottom:8px;">
                                <span style="background:#e3f6fc; color:#31708f; padding:2px 14px; border-radius:8px;">Parts Used</span>
                            </h3>
                            <table class="table table-bordered table-sm" style="width:100%; border-collapse:collapse;">
                                <thead style="background:#edf6fb;">
                                    <tr>
                                        <th style="width:40%;">Part</th>
                                        <th style="width:20%;">Quantity</th>
                                        <th style="width:20%;">Unit</th>
                                        <th style="width:20%;">Note</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr t-foreach="wo.parts_used_ids" t-as="part">
                                        <td><span t-field="part.product_id.name"/></td>
                                        <td><span t-field="part.quantity"/></td>
                                        <td><span t-field="part.uom_id.name"/></td>
                                        <td><span t-field="part.note"/></td>
                                    </tr>
                                    <tr t-if="not wo.parts_used_ids">
                                        <td colspan="4" style="color:#bbb; text-align:center;">No parts used for this workorder.</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <div style="border-radius:12px; background:#fff; padding:20px; box-shadow:0 2px 8px #e2e8f0;">
                            <h3 style="color:#3151b7; border-bottom:1px solid #e2e8f0; padding-bottom:4px; margin-bottom:8px;">
                                <span style="background:#e3f6fc; color:#31708f; padding:2px 14px; border-radius:8px;">Workorder Tasks &amp; Instructions</span>
                            </h3>
                            <p style="background:#e3f6fc; color:#3151b7; padding:8px 18px; border-radius:8px; margin-bottom:14px; font-size:15px;">
                                <b>Instructions:</b>
                                <br/>
                                Please follow the below checklist and record your remarks and completion status for each task.
                                <ul style="color:#3151b7; font-size:14px; margin-top:6px; margin-bottom:2px;">
                                    <li>Review each task and ensure all safety protocols are met before starting.</li>
                                    <li>Mark tasks as <b>Done</b> only after full completion and verification.</li>
                                    <li>Document any issues or deviations in the <b>Notes</b> column.</li>
                                    <li>Inform your supervisor immediately in case of critical incidents or delays.</li>
                                    <li>Return all tools and equipment after completion and update the work order accordingly.</li>
                                </ul>
                            </p>
                            <table class="table table-bordered table-sm" style="width:100%; border-collapse:collapse;">
                                <thead style="background:#e3f1fc;">
                                    <tr>
                                        <th style="width:40%;">Task</th>
                                        <th style="width:20%;">Section</th>
                                        <th style="width:20%;">Status</th>
                                        <th style="width:20%;">Notes</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr t-foreach="wo.workorder_task_ids" t-as="task">
                                        <td><span t-field="task.name"/></td>
                                        <td>
                                            <t t-if="task.section_id">
                                                <span t-field="task.section_id.name"/>
                                            </t>
                                            <t t-else="">
                                                <span style="color:#bbb;">&#8212;</span>
                                            </t>
                                        </td>
                                        <td>
                                            <t t-if="task.is_done">
                                                <span style="color:#28a745; font-weight:600;">&#10004; Done</span>
                                            </t>
                                            <t t-else="">
                                                <span style="color:#d63031; font-weight:600;">&#10006; Pending</span>
                                            </t>
                                        </td>
                                        <td><span t-field="task.notes"/></td>
                                    </tr>
                                    <tr t-if="not wo.workorder_task_ids">
                                        <td colspan="4" style="color:#bbb; text-align:center;">No tasks found for this workorder.</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </t>
            </t>
        </t>
    </template>
</odoo>